def format_sample(example):
    screen = example.get("input", "")
    full = example.get("full_summary", "")

    if not screen.strip() or not full.strip():
        return {"text": None}  # 빈값 제거

    messages = [
        {"role": "user", "content": f"다음 화면에 대한 요약을 생성하세요:\n{screen}"},
        {"role": "assistant", "content": full}
    ]
    return {"text": tokenizer.apply_chat_template(messages, tokenize=False)}

tokenized_train = tokenized_train.filter(lambda example: example["text"] and example["text"].strip())
tokenized_eval = tokenized_eval.filter(lambda example: example["text"] and example["text"].strip())

for i in range(5):
    print(repr(tokenized_eval[i]["text"]))
