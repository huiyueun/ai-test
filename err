from transformers import TrainingArguments

training_args = TrainingArguments(
    per_device_train_batch_size = 4,
    gradient_accumulation_steps = 4,
    num_train_epochs = 3,
    evaluation_strategy = "steps",
    save_strategy = "epoch",
    learning_rate = 2e-5,
    save_total_limit = 2,
    output_dir = "unsloth-multitask-output",
    optim = "adamw_8bit",
    fp16 = True,       # 반드시 True
    bf16 = False,      # 반드시 False
    logging_dir = "./logs",
    report_to = "tensorboard",
    logging_steps = 25,
)

trainer = SFTTrainer(
    model = model,
    tokenizer = tokenizer,
    train_dataset = tokenized_train,
    eval_dataset = tokenized_eval,
    args = training_args,
    dataset_text_field = "text",
    max_seq_length = 2048,
    packing = False,
)
