from transformers import TrainingArguments

training_args = TrainingArguments(
    output_dir = "unsloth-multitask-output",
    num_train_epochs = 3,
    per_device_train_batch_size = 4,
    gradient_accumulation_steps = 4,
    learning_rate = 2e-5,
    logging_dir = "./logs",
    logging_steps = 25,
    save_strategy = "epoch",       # only "no" or "epoch"
    save_total_limit = 2,
    optim = "adamw_8bit",
    fp16 = True,
    bf16 = False,
    report_to = "tensorboard",
)

trainer = SFTTrainer(
    model = model,
    tokenizer = tokenizer,
    train_dataset = tokenized_train,
    eval_dataset = tokenized_eval,
    args = training_args,
    dataset_text_field = "text",
    max_seq_length = 2048,
    packing = False,
)
