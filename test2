import os
import requests
import json
import base64

# API Key 설정
api_key = os.getenv("SHUTTLE_API_KEY")  # 또는 직접 문자열 삽입

# 인코딩: Base64 Basic Auth 방식
headers = {
    "Authorization": f"Basic {api_key}",
    "Content-Type": "application/json",
}

# 모델 URL
url = "https://inference-webtrial-api.shuttle.sr-cloud.com/gauss2-37b-instruct/v1/completions"

def ask_llm(prompt):
    payload = {
        "model": "gauss2-37b-instruct",
        "prompt": f"<|user|>\n{prompt}\n<|assistant|>\n",  # Shuttle 포맷 맞춤
        "temperature": 0.7,
        "max_tokens": 512,
        "stop": ["<|user|>", "<|endoftext|>"]
    }

    response = requests.post(url, headers=headers, data=json.dumps(payload))

    if response.status_code == 200:
        result = response.json()
        return result["choices"][0]["text"].strip()
    else:
        print("❌ Error:", response.status_code, response.text)
        return None

if __name__ == "__main__":
    question = input("질문을 입력하세요: ")
    answer = ask_llm(question)
    print("💡 답변:", answer)
